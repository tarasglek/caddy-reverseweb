{
	debug
	admin unix//tmp/caddy.sock
	http_port 9080
	https_port 9443
}

(cgi_proxy) {
	reverse-bin * /bin/sh -c "exec python3 -m http.server {args[0]}" {
		mode proxy
		reverse_proxy_to :{args[0]}
		readiness_check HEAD /
	}
}

http://python.{$DOMAIN:localhost} {
	bind 0.0.0.0
	import cgi_proxy 8001
}

http://*.{$DOMAIN:localhost} {
	bind 0.0.0.0
	reverse-bin * /bin/sh -c "exec python3 discover-app.py :8002" {
		dir ./examples/reverse-proxy/apps/discover-app
		mode proxy
		reverse_proxy_to :8002
		readiness_check HEAD /
	}
}
